<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hola, tÃº.</title>

<style>
body{
    margin:0;
    height:100vh;
    background: radial-gradient(circle at center, #050505 0%, #000 80%);
    display:flex;
    justify-content:center;
    align-items:center;
    font-family: Georgia, serif;
    overflow:hidden;
    color:#f5f5f5;
}

.scene{
    perspective:1500px;
}

.envelope{
    position:relative;
    width:360px;
    height:240px;
    background:#111;
    transform-style:preserve-3d;
    transition:transform 1.2s ease;
    cursor:pointer;
    box-shadow:0 0 60px rgba(255,255,255,0.05);
}

.flap{
    position:absolute;
    width:100%;
    height:100%;
    background:#1c1c1c;
    clip-path: polygon(0 0, 50% 55%, 100% 0);
    transform-origin:top;
    transition:transform 1.2s ease;
}

.letter{
    position:absolute;
    width:100%;
    height:100%;
    background:#0a0a0a;
    top:0;
    left:0;
    padding:30px;
    box-sizing:border-box;
    transform:translateY(100%);
    transition:transform 1.2s ease;
    overflow:auto;
}

.envelope.open .flap{
    transform:rotateX(180deg);
}

.envelope.open .letter{
    transform:translateY(0);
}

h1{
    text-align:center;
    letter-spacing:3px;
}

#text{
    white-space:pre-line;
    line-height:1.9em;
    font-size:1.05em;
    margin-top:15px;
}

button{
    margin-top:20px;
    padding:10px 25px;
    background:white;
    border:none;
    cursor:pointer;
    font-weight:bold;
    transition:0.4s;
}

button:hover{
    background:#bbb;
}
</style>
</head>

<body>

<div class="scene">
<div class="envelope" onclick="openEnvelope()">
    <div class="flap"></div>
    <div class="letter">
        <h1>Hola, tÃº.</h1>
        <div id="text"></div>
        <button onclick="startExperience(event)">ðŸŽµ Escuchar lo inevitable</button>
    </div>
</div>
</div>

<audio id="music" loop>
    <source src="iwannabeyours.mp3" type="audio/mpeg">
</audio>

<script>
const message = `Naomi...

No fue coincidencia.
No fue casualidad.

Entre millones de personas,
mi mente insiste en volver a ti.

Te observo.
Te pienso.
Te elijo.

Hay algo en ti que no se explica,
solo se siente.

Y aunque el mundo siga girando,
yo sigo aquÃ­â€¦

Inevitablemente tuyo.`;

let i = 0;
let started = false;
const music = document.getElementById("music");

function openEnvelope(){
    document.querySelector(".envelope").classList.add("open");
    if(!started){
        started = true;
        typeWriter();
    }
}

function typeWriter(){
    if(i < message.length){
        document.getElementById("text").innerHTML += message.charAt(i);
        i++;
        setTimeout(typeWriter, 28);
    }
}

function startExperience(event){
    event.stopPropagation();

    music.volume = 1.0;

    // Reinicia por si estaba bloqueado
    music.pause();
    music.currentTime = 0;

    music.play().then(() => {
        console.log("Audio iniciado correctamente");
    }).catch(() => {
        alert("Toca nuevamente el botÃ³n para activar el sonido ðŸ”Š");
    });
}
</script>

</body>
</html>